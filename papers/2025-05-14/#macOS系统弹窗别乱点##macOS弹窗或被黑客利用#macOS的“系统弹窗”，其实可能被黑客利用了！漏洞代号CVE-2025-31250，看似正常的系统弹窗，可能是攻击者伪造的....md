# #macOS系统弹窗别乱点##macOS弹窗或被黑客利用#macOS的“系统弹窗”，其实可能被黑客利用了！漏洞代号CVE-2025-31250，看似正常的系统弹窗，可能是攻击者伪造的...

**URL**: https://weibo.com/6105753431/PrNrW6gFB

## 原始摘要

<a href="https://m.weibo.cn/search?containerid=231522type%3D1%26t%3D10%26q%3D%23macOS%E7%B3%BB%E7%BB%9F%E5%BC%B9%E7%AA%97%E5%88%AB%E4%B9%B1%E7%82%B9%23&amp;extparam=%23macOS%E7%B3%BB%E7%BB%9F%E5%BC%B9%E7%AA%97%E5%88%AB%E4%B9%B1%E7%82%B9%23" data-hide=""><span class="surl-text">#macOS系统弹窗别乱点#</span></a><a href="https://m.weibo.cn/search?containerid=231522type%3D1%26t%3D10%26q%3D%23macOS%E5%BC%B9%E7%AA%97%E6%88%96%E8%A2%AB%E9%BB%91%E5%AE%A2%E5%88%A9%E7%94%A8%23&amp;extparam=%23macOS%E5%BC%B9%E7%AA%97%E6%88%96%E8%A2%AB%E9%BB%91%E5%AE%A2%E5%88%A9%E7%94%A8%23" data-hide=""><span class="surl-text">#macOS弹窗或被黑客利用#</span></a><br><br>macOS的“系统弹窗”，其实可能被黑客利用了！<br><br>漏洞代号CVE-2025-31250，看似正常的系统弹窗，可能是攻击者伪造的。<br><br>问题出在macOS的TCC权限管理系统，用户点击“信任”按钮后，你可能已经帮攻击者打开了麦克风、摄像头，甚至允许了更深层的控制权限。<br><br>比如，你打开Safari浏览器，突然跳出一个“麦克风权限请求”，你可能会觉得合理，然后点击“允许”。<br><br>这件事提醒我们：<br><br>- 不要轻易点击任何权限弹窗，特别是那种来路不明的；<br><br>- 如果你不确定哪个App在请求权限，先点“拒绝”；<br><br>- 在“系统设置 - 隐私与安全性”下的“自动化”一栏，可以查看Apple Events相关权限；<br><br>- 系统自带的命令行工具`tccutil`，可以查看和撤销权限；<br><br>- 安装App时，尽量选择App Store下载来源，避免下载未知来源的软件；<br><br>- 有能力的用户，可以使用Apple Endpoint Security框架，监控权限变动；<br><br>- 安装系统更新时，别只看数字版本，也要关注有没有安全补丁。<br><br>目前，这个漏洞只在macOS Sequoia 15.5被修复。macOS Ventura 13.7.6和Sonoma 14.7.6还未修补，依然可以复现漏洞。<br><br>下次看到弹窗时，多问自己一句：它真的是你打开的App弹出来的吗？<br><br>---下面是漏洞解析，偏技术向---<br><br>macOS的TCC权限，底层依赖的是一个私有API，通过向`tccd`守护进程发送XPC消息完成权限请求。<br><br>正常情况下，系统会校验请求的来源 App 和显示的名称是否一致。<br><br>但在`TCCAccessRequestIndirect`这个函数的实现中，Apple留了一个“设计不一致”的漏洞：<br><br>- XPC消息中的`target_path`用于展示弹窗中显示的App名；<br><br>- `target_identifier`决定实际写入TCC权限数据库的是谁；<br><br>- 而这两个字段在这段逻辑中没有强制一致性校验。<br><br>攻击者正是利用了这点，伪造出了一个权限请求，展示一个可信App的名字，但把权限给了其他App。<br><br>值得一提的是，早期macOS的`tccd`，曾被曝使用`$HOME`环境变量来决定权限数据库路径，这在当年，还引发过一次TCC完全绕过攻击（漏洞代号CVE-2020-9934）。<br><br>感兴趣的小伙伴可以查看原文：<a href="https://weibo.cn/sinaurl?u=https%3A%2F%2Fwts.dev%2Fposts%2Ftcc-who%2F" data-hide=""><span class="url-icon"><img style="width: 1rem;height: 1rem" src="https://h5.sinaimg.cn/upload/2015/09/25/3/timeline_card_small_web_default.png" referrerpolicy="no-referrer"></span><span class="surl-text">网页链接</span></a><img style="" src="https://tvax2.sinaimg.cn/large/006Fd7o3gy1i1f4lhlbeej30ko0jsgqj.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax4.sinaimg.cn/large/006Fd7o3ly1i1f4nun2lej31e20u0gnq.jpg" referrerpolicy="no-referrer"><br><br><br clear="both"><div style="clear: both"></div><video controls="controls" poster="https://tvax3.sinaimg.cn/orj480/006Fd7o3ly1i1f4nuqhuqj31e20u0gnq.jpg" style="width: 100%"><source src="https://f.video.weibocdn.com/o0/UbwFvvTIlx08oeTPIUhy010412007zUc0E010.mp4?label=mp4_720p&amp;template=1200x720.25.0&amp;ori=0&amp;ps=1CwnkDw1GXwCQx&amp;Expires=1747216952&amp;ssig=QbhZSB6Pch&amp;KID=unistore,video"><source src="https://f.video.weibocdn.com/o0/iWwfpVzOlx08oeTPrvTO010412004hbb0E010.mp4?label=mp4_hd&amp;template=800x480.25.0&amp;ori=0&amp;ps=1CwnkDw1GXwCQx&amp;Expires=1747216952&amp;ssig=5MN0FYYR7y&amp;KID=unistore,video"><source src="https://f.video.weibocdn.com/o0/te6X0KAHlx08oeTPeP1S010412002WMe0E010.mp4?label=mp4_ld&amp;template=600x360.25.0&amp;ori=0&amp;ps=1CwnkDw1GXwCQx&amp;Expires=1747216952&amp;ssig=GsOeq557hC&amp;KID=unistore,video"><p>视频无法显示，请前往<a href="https://video.weibo.com/show?fid=1034%3A5166248854749235" target="_blank" rel="noopener noreferrer">微博视频</a>观看。</p></video>

## AI 摘要

macOS系统存在一个高危漏洞(CVE-2025-31250)，黑客可伪造系统弹窗诱导用户授予权限。该漏洞源于TCC权限管理系统未校验请求来源与显示名称的一致性，攻击者可伪装成可信App获取麦克风、摄像头等敏感权限。目前仅macOS Sequoia 15.5修复该漏洞。建议用户：谨慎处理权限弹窗、优先拒绝可疑请求、通过系统设置检查权限、使用tccutil工具管理权限、仅从App Store下载应用。技术层面，漏洞源于TCCAccessRequestIndirect函数未强制校验target_path和target_identifier字段的一致性。

## 元数据

- **来源**: ArXiv
- **类型**: 论文
- **保存时间**: 2025-05-14T09:03:03Z
- **目录日期**: 2025-05-14
