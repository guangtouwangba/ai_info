# #A2A协议实战教程##使用A2A协议构建多智能体系统#你可能早早就听说过Agent2Agent (A2A) 协议。本周，A2A协议的官方Python SDK发布，如何用它实现智能体间通信呢...

**URL**: https://weibo.com/6105753431/Pu5gK2aZ8

## 原始摘要

<a href="https://m.weibo.cn/search?containerid=231522type%3D1%26t%3D10%26q%3D%23A2A%E5%8D%8F%E8%AE%AE%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%23&amp;extparam=%23A2A%E5%8D%8F%E8%AE%AE%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%23" data-hide=""><span class="surl-text">#A2A协议实战教程#</span></a><a href="https://m.weibo.cn/search?containerid=231522type%3D1%26t%3D10%26q%3D%23%E4%BD%BF%E7%94%A8A2A%E5%8D%8F%E8%AE%AE%E6%9E%84%E5%BB%BA%E5%A4%9A%E6%99%BA%E8%83%BD%E4%BD%93%E7%B3%BB%E7%BB%9F%23&amp;extparam=%23%E4%BD%BF%E7%94%A8A2A%E5%8D%8F%E8%AE%AE%E6%9E%84%E5%BB%BA%E5%A4%9A%E6%99%BA%E8%83%BD%E4%BD%93%E7%B3%BB%E7%BB%9F%23" data-hide=""><span class="surl-text">#使用A2A协议构建多智能体系统#</span></a><br><br>你可能早早就听说过Agent2Agent (A2A) 协议。<br><br>本周，A2A协议的官方Python SDK发布，如何用它实现智能体间通信呢？<br><br>下面这篇文章，通过实战案例讲解如何使用A2A Python SDK构建多智能体系统：<br><br>一、事件检测智能体与A2A客户端之间的通信<br><br>系统中有三个角色：用户、事件智能体（负责检测事件）和警报智能体（负责向用户发出事件警报）。它们都使用消息（Messages）进行通信。每条消息代表A2A协议中的一次通信轮次。<br><br>智能体被封装于暴露HTTP端点的A2A服务器中。每个A2A服务器包含事件队列（Event queues），用于缓冲智能体的异步执行和服务器响应处理。<br><br>A2A客户端（A2A Client）负责发起通信，A2A服务器亦可扮演客户端角色。【图1】展示了客户端和服务器在协议内如何进行通信。<br><br>EventQueue存储了消息（Messages）、任务（Tasks）、任务状态更新事件（TaskStatusUpdateEvent）、任务工件更新事件（TaskArtifactUpdateEvent）、A2AError 和JSONRPCError对象。<br><br>任务（Task）是构建多智能体系统的核心概念：<br><br>- 客户端发送消息时，智能体可能创建有状态任务（如“生成报告”）。<br><br>- 每个任务有唯一ID和生命周期（submitted, working, input-required, completed, failed）<br><br>- 任务是有状态的，可能涉及客户端与服务器间的多次消息交换。<br><br>本系统中的任务包括：检测事件和提醒用户。<br><br>二、为事件智能体构建A2A服务器<br><br>首先，需为事件检测智能体定义智能体卡片（Agent Card）。【图2】<br><br>这是一个JSON文档，描述了服务器身份、能力（Capabilities）、技能（Skills）、服务端点（Service endpoint）URL，以及客户端如何进行身份验证和交互。<br><br>智能体本身是一个Uvicorn服务器，main() 方法负责服务器启动。<br><br>所有请求由a2a-python SDK的DefaultRequestHandler处理。该处理程序需配置TaskStore用于任务存储，以及AgentExecutor实例来执行代理的核心逻辑。<br><br>main() 方法的最后组件是A2AStarletteApplication，一个实现A2A协议服务器端点的Starlette应用。它需通过智能体卡片和 DefaultRequestHandler进行初始化。最终，使用uvicorn运行应用程序。【图4】<br><br>三、创建EventAgentExecutor<br><br>现在是时候构建智能体的核心，并最终了解如何使用任务让智能体彼此交互了。<br><br>EventAgentExecutor类继承自AgentExecutor接口，要求实现 execute() 和 cancel() 方法。<br><br>两者均接收RequestContext和EventQueue对象作为参数。RequestContext封装当前请求信息，而EventQueue充当智能体异步执行与服务器响应处理间的缓冲区。<br><br>智能体逻辑简化为检测用户消息中是否包含字符串 "event"。若存在，则通过向警报智能体发送消息来调用它。<br><br>这采用静态配置策略，即为事件智能体配置警报智能体的智能体卡片URL。在此场景下，事件智能体扮演A2A客户端角色。<br><br>执行器构建步骤如下：首先创建主任务（事件检测任务），实例化 TaskUpdater对象（辅助智能体向任务事件队列发布更新的类），提交任务并通过 start_work() 方法宣布开始处理。【图5】<br><br>用户发送给智能体的消息包含一个或多个Part，代表独立内容片段，可以是TextPart、FilePart或DataPart。本例使用TextPart，需在执行器中对其进行解包。【图6】<br><br>若消息中不包含字符串 "event"，则无需调用警报智能体，任务即告完成。【图7】<br><br>四、为用户创建A2A客户端<br><br>构建A2A客户端以测试智能体。客户端通过 A2AClient 类中的 get_client_from_agent_card_url() 方法获取智能体卡片。<br><br>随后，将消息封装于SendMessageRequest对象中，并利用客户端的 send_message() 方法将其发送给智能体。【图8】<br><br>五、让事件智能体与警报智能体对话<br><br>为了让事件智能体与警报智能体对话，事件智能体也将扮演客户端的角色。【图9】<br><br>调用警报智能体，就像作为用户调用事件智能体一样，当警报智能体的任务完成时，就完成原始的事件智能体任务。现在再次调用事件智能体，但这次带上一个事件。【图10】<br><br>此处的精妙之处在于，只需调用警报智能体，无需了解其如何向用户发出警报。仅需向其发送一条消息，并等待其完成任务即可。<br><br>更多内容，欢迎查看原文：<a href="https://weibo.cn/sinaurl?u=https%3A%2F%2Ftowardsdatascience.com%2Fmulti-agent-communication-with-the-a2a-python-sdk%2F" data-hide=""><span class="url-icon"><img style="width: 1rem;height: 1rem" src="https://h5.sinaimg.cn/upload/2015/09/25/3/timeline_card_small_web_default.png" referrerpolicy="no-referrer"></span><span class="surl-text">网页链接</span></a><img style="" src="https://tvax1.sinaimg.cn/large/006Fd7o3gy1i1wiqqsfn9j30xc0ivgo5.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax4.sinaimg.cn/large/006Fd7o3gy1i1wiqsusn2j312m0r0aj2.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax2.sinaimg.cn/large/006Fd7o3gy1i1wiqv35kdj31361kgas6.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax2.sinaimg.cn/large/006Fd7o3gy1i1wir30b4qj36aw1i0x4k.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax1.sinaimg.cn/large/006Fd7o3gy1i1wir4935zj319y0aa0xa.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax2.sinaimg.cn/large/006Fd7o3gy1i1wir86x9nj31bb0fkqao.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax3.sinaimg.cn/large/006Fd7o3gy1i1wir9oqyoj31i40ng7ez.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax4.sinaimg.cn/large/006Fd7o3gy1i1wirbn40qj315f12aqgl.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax3.sinaimg.cn/large/006Fd7o3gy1i1wirexzpvj31fg1kgts1.jpg" referrerpolicy="no-referrer"><br><br><img style="" src="https://tvax1.sinaimg.cn/large/006Fd7o3gy1i1wirjgpnwj30xc0dotil.jpg" referrerpolicy="no-referrer"><br><br>

## AI 摘要

A2A协议Python SDK发布，支持构建多智能体系统。该系统包含事件检测智能体和警报智能体，通过消息进行通信。智能体封装在A2A服务器中，使用事件队列缓冲异步执行。核心概念是任务(Task)，具有唯一ID和生命周期状态。实战演示了如何：1) 定义智能体卡片(JSON文档)描述能力；2) 构建Uvicorn服务器处理请求；3) 实现执行器逻辑检测事件并触发警报；4) 创建客户端测试交互。智能体可双向通信，事件智能体可调用警报智能体完成任务，无需了解其内部实现。

## 元数据

- **来源**: ArXiv
- **类型**: 论文
- **保存时间**: 2025-05-30T01:29:07Z
- **目录日期**: 2025-05-30
